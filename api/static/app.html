<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Bootstrap CSS -->
    <link href="Bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <!-- title displayed on the browser tab -->
    <title>Tumorclass.info</title>
  </head>

  <!-- contains our front-end elements -->
  <body>
    <h1>Predict Brain Tumor</h1>
    <!--input to upload the image-->
    <input id="upload" type="file" />
    <!--button to activate the script which call our Flask app-->
    <button id="predict-button">Predict</button>
    <!--parapgraph where we will display the result-->
    <!-- <p><span id="prediction"></span></p> -->
    <!-- enable multiline -->
    <!--display the uploaded image-->
    <div id="image-container"></div>
    <img id="selected-image" src="" width="400" height="400" />
    <p id="prediction" style="white-space: pre-wrap"></p>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="Bootstrap/js/bootstrap.bundle.min.js"></script>
  </body>

  <!--jquery lib-->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

  <!--The script which call our Flask app-->
  <script>
    let base64Image;
    // when we upload an image
    $("#upload").change(function () {
      let reader = new FileReader();
      reader.onload = function (e) {
        let dataURL = reader.result;
        $("#selected-image").attr("src", dataURL);
        base64Image = dataURL.replace("data:image/png;base64,", "");
      };
      reader.readAsDataURL($("#upload")[0].files[0]);
      //reset pred text as empty
      $("#prediction").text("");
    });

    $("#predict-button").click(function () {
      let message = { image: base64Image };
      // you could also use 127.0.0.1 instead of 0.0.0.0
      $.post(
        "http://127.0.0.1:5000/predict",
        JSON.stringify(message),
        function (response) {
          let result = "Result: " + response.classification;
          let confidence = "Confidence : " + response.confidence;
          let normal = "Normal : " + response.normal;
          let lgg = "LGG : " + response.lgg;
          let hgg = "HGG : " + response.hgg;
          $("#prediction").text(
            result +
              "\n" +
              confidence +
              "\n" +
              "\n" +
              normal +
              "\n" +
              lgg +
              "\n" +
              hgg
          );
          console.log(response);
        }
      );
    });
  </script>
</html>
